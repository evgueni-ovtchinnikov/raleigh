numpy.random.seed(1) # make results reproducible
dtype = numpy.float32
m = 65000
n = 15000
k = 500
alpha = 0.05
f_sigma = lambda t: 2**(-alpha*t).astype(dtype)
sigma0, u0, v0, A = random_matrix_for_svd(m, n, k, f_sigma, dtype)
th = 0.01
block_size = 64
vec_tol = 1e-4
try_gpu = True

--- generating the matrix...

--- solving with raleigh.ndarray.svd...
devices found: 1
device: b'Quadro K4200'
memory: 4294967296
multiprocessors: 7
threads per mp: 2048
registers per block: 65536
shared memory per block: 49152
dropped 21 search directions out of 64
dropped 22 search directions out of 64
right eigenpair 62 stagnated,
 eigenvalue 1.497339e-02, error 3.5e-04 / -1.0e+00
dropped 27 search directions out of 64
dropped 25 search directions out of 64
dropped 13 search directions out of 64
right eigenpair 121 stagnated,
 eigenvalue 1.976409e-04, error 1.3e-04 / 1.1e-03
right eigenpair 123 stagnated,
 eigenvalue 1.874860e-04, error 1.5e-04 / 2.4e-03
right eigenpair 125 stagnated,
 eigenvalue 1.742187e-04, error 1.4e-04 / -1.0e+00
dropped 31 search directions out of 64

137 singular values converged in 12 iterations

singular vector errors (raleigh):
[  2.16764784e-06   2.29683246e-06   2.74322110e-06   2.43103864e-06
   3.12511634e-06   2.83976897e-06   3.16824321e-06   3.56243277e-06
   3.48059348e-06   3.66524932e-06   3.78317554e-06   3.49160678e-06
   3.47964715e-06   3.93543769e-06   4.25782900e-06   3.69711415e-06
   4.10628127e-06   4.67256677e-06   4.06542358e-06   5.08696348e-06
   5.00230772e-06   5.49232891e-06   5.56960595e-06   5.57251406e-06
   4.87292937e-06   5.82827624e-06   6.10956249e-06   7.03386695e-06
   6.21325989e-06   7.48137518e-06   7.76367779e-06   8.27778786e-06
   1.14083841e-05   1.38543428e-05   1.71928441e-05   1.69118575e-05
   1.66407881e-05   1.91967665e-05   2.69031698e-05   2.44278563e-05
   2.60375891e-05   2.33698593e-05   2.87406619e-05   2.87854946e-05
   3.22148262e-05   2.92467721e-05   4.24601494e-05   4.07052685e-05
   4.75593770e-05   5.56151645e-05   7.36703005e-05   8.42153167e-05
   9.65237705e-05   9.38416269e-05   1.10931440e-04   9.91186680e-05
   1.14983282e-04   1.26705636e-04   1.20323370e-04   1.12957801e-04
   1.51706918e-04   1.59496805e-04   1.38855758e-04   3.19782316e-06
   1.66368300e-05   4.11839437e-06   3.51154667e-05   3.94413064e-06
   3.72662112e-06   5.95583242e-06   3.78856589e-06   3.48095978e-06
   3.98044722e-06   5.23809513e-06   3.93932896e-06   3.42673570e-06
   4.54407973e-06   4.84933980e-06   4.24075506e-06   5.64214542e-06
   6.64773233e-06   6.27833333e-06   6.17049682e-06   7.79414586e-06
   1.09819212e-05   8.28800876e-06   1.10726796e-05   1.32907571e-05
   1.49936095e-05   1.63945479e-05   1.69623345e-05   2.19788581e-05
   1.73135486e-05   2.55431150e-05   2.62349749e-05   3.15225334e-05
   3.22763990e-05   3.40429542e-05   3.56011260e-05   5.12976039e-05
   4.74854969e-05   4.92041981e-05   6.09384624e-05   5.97593826e-05
   8.18827612e-05   5.36924563e-05   5.73892576e-05   9.43397899e-05
   8.83838729e-05   7.71860578e-05   7.59533723e-05   1.29528213e-04
   9.48390734e-05   1.10193338e-04   1.16329706e-04   1.65842459e-04
   1.54065216e-04   1.55059286e-04   1.60279349e-04   2.28722187e-04
   2.22680290e-04   2.70761026e-04   1.79509385e-04   3.47896013e-04
   2.85629474e-04   2.56173807e-04   1.35125025e-04   1.42735473e-04
   8.37204716e-05   2.80050328e-04   1.46330058e-04   1.24188125e-04
   2.88658310e-04   1.84347518e-04   6.45855500e-04   3.50937922e-03
   2.97607388e-03]

singular value errors (raleigh):
[  1.43051147e-06   2.44379044e-06   1.96695328e-06   2.80141830e-06
   4.17232513e-07   0.00000000e+00   0.00000000e+00   5.36441803e-07
   7.74860382e-07   1.25169754e-06   2.38418579e-07   1.19209290e-06
   5.36441803e-07   3.57627869e-07   2.98023224e-07   4.17232513e-07
   3.57627869e-07   2.98023224e-07   5.96046448e-08   4.76837158e-07
   6.55651093e-07   2.98023224e-07   0.00000000e+00   2.38418579e-07
   2.38418579e-07   1.78813934e-07   4.17232513e-07   5.96046448e-07
   4.76837158e-07   8.34465027e-07   5.96046448e-08   7.15255737e-07
   8.94069672e-08   3.27825546e-07   2.98023224e-07   3.87430191e-07
   4.47034836e-07   5.06639481e-07   6.55651093e-07   2.98023224e-08
   2.98023224e-08   2.38418579e-07   2.98023224e-07   4.76837158e-07
   3.57627869e-07   8.94069672e-08   0.00000000e+00   2.38418579e-07
   1.63912773e-07   4.76837158e-07   0.00000000e+00   0.00000000e+00
   2.08616257e-07   1.78813934e-07   4.47034836e-08   1.04308128e-07
   2.53319740e-07   4.47034836e-08   2.98023224e-07   0.00000000e+00
   1.34110451e-07   1.63912773e-07   2.01165676e-07   7.45058060e-08
   2.38418579e-07   1.41561031e-07   1.71363354e-07   1.41561031e-07
   2.38418579e-07   1.11758709e-07   1.04308128e-07   5.96046448e-08
   5.96046448e-08   5.21540642e-08   6.70552254e-08   3.72529030e-08
   9.68575478e-08   8.19563866e-08   1.49011612e-08   6.70552254e-08
   9.68575478e-08   2.23517418e-08   8.19563866e-08   4.47034836e-08
   1.49011612e-08   0.00000000e+00   1.08033419e-07   1.19209290e-07
   3.35276127e-08   1.11758709e-08   1.04308128e-07   2.23517418e-08
   1.86264515e-08   3.72529030e-08   1.11758709e-08   1.49011612e-08
   3.72529030e-09   2.23517418e-08   1.49011612e-08   2.60770321e-08
   3.35276127e-08   3.72529030e-09   2.23517418e-08   1.11758709e-08
   2.04890966e-08   1.11758709e-08   7.07805157e-08   5.77419996e-08
   1.49011612e-08   1.86264515e-09   1.11758709e-08   3.72529030e-09
   5.58793545e-09   1.67638063e-08   3.72529030e-09   2.04890966e-08
   2.04890966e-08   5.58793545e-09   9.31322575e-09   3.53902578e-08
   1.11758709e-08   2.60770321e-08   1.58324838e-08   1.30385160e-08
   2.79396772e-09   1.95577741e-08   5.58793545e-09   5.58793545e-09
   9.31322575e-10   1.49011612e-08   1.39698386e-08   8.38190317e-09
   6.51925802e-09   1.30385160e-08   3.72529030e-09   1.11758709e-08
   7.45058060e-09]

--- solving with restarted scipy.sparse.linalg.svds...
last singular value computed: 1.165101e-01
deflating...
restarting...
last singular value computed: 1.263607e-02
deflating...
restarting...
last singular value computed: 9.637970e-04

singular vector errors (svds):
[  2.59307876e-06   2.57281727e-06   2.60043976e-06   2.79527058e-06
   2.72348166e-06   3.12563020e-06   2.67331961e-06   2.51871802e-06
   3.06473521e-06   2.52940868e-06   3.11325971e-06   3.32523837e-06
   2.68908616e-06   3.19244145e-06   2.71835597e-06   4.12973031e-06
   3.05813228e-06   3.23904510e-06   3.24631014e-06   3.06506445e-06
   3.91373123e-06   2.96561984e-06   2.70375017e-06   3.08101926e-06
   5.30155239e-06   3.40696147e-06   4.21483310e-06   5.34341279e-06
   4.38103098e-06   4.26945553e-06   6.15034605e-06   5.92795141e-06
   6.93479433e-06   1.19514689e-05   8.53476013e-06   6.40030385e-06
   1.17648124e-05   7.35029425e-06   4.40938766e-06   7.41631584e-06
   1.59266019e-05   4.87463831e-06   5.91665639e-06   1.10831261e-05
   2.05982142e-05   7.32467743e-06   1.56023725e-05   1.54178015e-05
   3.05416506e-05   2.58849323e-05   1.80738189e-05   3.18780621e-05
   3.02840454e-05   4.38987408e-05   4.99310454e-06   1.13814831e-05
   2.23623047e-05   9.75628700e-06   3.83849911e-05   7.10696550e-05
   4.43114950e-05   6.22847656e-05   4.97599649e-06   9.75129296e-06
   2.48805782e-06   2.63473703e-06   2.55804184e-06   2.53114467e-06
   2.79028177e-06   2.77071626e-06   2.89543868e-06   2.89445029e-06
   2.58387968e-06   3.06607285e-06   3.08120980e-06   3.15800708e-06
   3.18785965e-06   3.88793387e-06   3.70595535e-06   2.69358588e-06
   3.45326566e-06   3.70623343e-06   3.62193214e-06   5.37131564e-06
   4.63312881e-06   6.01411057e-06   4.94017013e-06   3.30636453e-06
   8.25391726e-06   7.29902104e-06   8.64907179e-06   7.33202842e-06
   4.19833941e-06   7.30913462e-06   6.97008727e-06   1.33447593e-05
   1.18945436e-05   1.27335079e-05   3.27409793e-06   1.08889999e-05
   4.74980925e-06   3.76998241e-06   1.04925921e-05   2.21927403e-05
   8.48725176e-06   2.03405853e-05   1.27111216e-05   1.84553610e-05
   2.95752307e-06   3.39213329e-05   4.08696542e-06   2.56597505e-05
   1.70438398e-05   2.71347944e-05   1.19514334e-05   3.72567411e-05
   2.17841425e-05   1.57237591e-05   2.51324000e-05   4.46003014e-06
   4.99396228e-05   2.78800489e-05   3.57519166e-05   1.50948681e-05
   8.99114020e-05   4.36563641e-05   7.69600883e-05   1.25379638e-05
   2.60940828e-06   2.61873834e-06   2.59104127e-06   2.84952876e-06
   2.83527424e-06   2.79024675e-06   3.03861179e-06   3.66622430e-06
   3.90319929e-06]

singular value errors (svds):
[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   3.57627869e-07   1.78813934e-07   5.96046448e-08
   1.19209290e-07   5.96046448e-08   0.00000000e+00   1.19209290e-07
   5.96046448e-08   0.00000000e+00   1.19209290e-07   0.00000000e+00
   5.96046448e-08   5.96046448e-08   0.00000000e+00   5.96046448e-08
   0.00000000e+00   1.19209290e-07   0.00000000e+00   0.00000000e+00
   1.19209290e-07   0.00000000e+00   5.96046448e-08   5.96046448e-08
   5.96046448e-08   0.00000000e+00   2.38418579e-07   5.96046448e-08
   5.96046448e-08   8.94069672e-08   1.49011612e-07   8.94069672e-08
   1.49011612e-07   8.94069672e-08   5.96046448e-08   2.98023224e-08
   2.98023224e-08   0.00000000e+00   2.98023224e-08   5.96046448e-08
   8.94069672e-08   2.98023224e-08   5.96046448e-08   2.98023224e-08
   1.49011612e-07   1.49011612e-07   0.00000000e+00   7.45058060e-08
   2.98023224e-08   0.00000000e+00   2.98023224e-08   0.00000000e+00
   4.47034836e-08   2.98023224e-08   5.96046448e-08   5.96046448e-08
   2.98023224e-08   8.94069672e-08   1.49011612e-08   0.00000000e+00
   0.00000000e+00   1.49011612e-08   7.45058060e-09   2.98023224e-08
   2.23517418e-08   0.00000000e+00   0.00000000e+00   7.45058060e-09
   0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   7.45058060e-09   7.45058060e-09   0.00000000e+00   0.00000000e+00
   7.45058060e-09   7.45058060e-09   0.00000000e+00   0.00000000e+00
   7.45058060e-09   7.45058060e-09   7.45058060e-09   7.45058060e-09
   3.72529030e-09   1.49011612e-08   1.49011612e-08   3.72529030e-09
   0.00000000e+00   1.49011612e-08   0.00000000e+00   0.00000000e+00
   0.00000000e+00   1.49011612e-08   3.72529030e-09   3.72529030e-09
   7.45058060e-09   3.72529030e-09   3.72529030e-09   1.86264515e-08
   1.86264515e-09   9.31322575e-09   3.72529030e-09   3.72529030e-09
   3.72529030e-09   1.11758709e-08   3.72529030e-09   1.86264515e-09
   0.00000000e+00   1.11758709e-08   5.58793545e-09   5.58793545e-09
   0.00000000e+00   1.86264515e-09   5.58793545e-09   1.86264515e-09
   0.00000000e+00   9.31322575e-10   3.72529030e-09   3.72529030e-09
   2.60770321e-08   2.79396772e-09   2.51457095e-08   0.00000000e+00
   9.31322575e-10   2.79396772e-09   0.00000000e+00   9.31322575e-10
   9.31322575e-10   9.31322575e-10   9.31322575e-10   9.31322575e-10
   0.00000000e+00]

singular values (svds):
[ 1.          0.99502778  0.95336539  0.95092958  0.8521297   0.83726269
  0.80606061  0.78680056  0.77238125  0.76552826  0.76171768  0.72984028
  0.72927922  0.72620779  0.72531366  0.71632463  0.70998287  0.69003397
  0.68046772  0.63621426  0.63613075  0.62445915  0.62337387  0.62101889
  0.61911356  0.61352634  0.59167093  0.58606559  0.57227582  0.55041009
  0.5271672   0.50926548  0.46299309  0.42162231  0.3974365   0.39368889
  0.37361491  0.35476056  0.31948757  0.31927133  0.31742516  0.31631795
  0.31528625  0.30728003  0.29777741  0.28787258  0.25759679  0.2521244
  0.24417903  0.22953005  0.20227565  0.18227506  0.18102667  0.1711909
  0.1701051   0.16749725  0.15555607  0.15150009  0.14666307  0.14056513
  0.1371865   0.12643187  0.12236583  0.11651006  0.11631308  0.11358347
  0.11223708  0.10526843  0.10351694  0.09644702  0.09586591  0.0941744
  0.09307037  0.09252531  0.08968129  0.08797187  0.08406875  0.08346313
  0.08185537  0.08043145  0.07881668  0.07877941  0.07872961  0.07110368
  0.06620458  0.06513638  0.06219661  0.06157861  0.05707508  0.05281525
  0.05056721  0.04962136  0.04917156  0.04729896  0.04306138  0.04130912
  0.03972949  0.03879641  0.03812655  0.03537297  0.0350851   0.0338928
  0.03235925  0.03209764  0.02957513  0.02926263  0.02898707  0.02716698
  0.02625086  0.02559767  0.02545081  0.02159799  0.02136852  0.02028928
  0.02005529  0.01930813  0.01768295  0.01747221  0.01726277  0.01648372
  0.01569735  0.01405847  0.01377273  0.01369256  0.01362144  0.01319918
  0.01264507  0.01263607  0.0116472   0.01163732  0.01112848  0.01101018
  0.01066134  0.01045574  0.010276    0.01016582  0.01005595]

 time: raleigh 1.1e+01, svds 1.6e+02
